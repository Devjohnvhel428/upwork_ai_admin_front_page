import{r,j as e,B as l}from"./index-K7BRA8gO.js";import{C as k,F as y,f as P,a as A}from"./index-BXuZBxIn.js";import{c as L,a as m}from"./index.esm-BQ9lYq6b.js";import{h as E}from"./moment-C5S46NFB.js";import{a as M,s as B,d as I}from"./auth.service-B2nlOctG.js";import{c as Y,C as _,d as H}from"./DefaultLayout-DCen-7yv.js";import{C as O,a as z}from"./CRow-DGa8L2ab.js";import{C as $,a as q}from"./CCardBody-Bb7oBdg0.js";import{C as G}from"./CCardHeader-D985vdUT.js";import{C as J}from"./CFormInput-DV9HJT9z.js";import{C as K,a as Q,b as w,c,d as V,e as i}from"./CTable-DQQmY1x0.js";import{C as W}from"./CFormSelect-BB8CZiBd.js";const xe=()=>{const[X,b]=r.useState({_id:"",name:"",email:"",password:"",role:"user",created:null,lastLogin:null}),[N,v]=r.useState([]),[d,j]=r.useState(1),[p,T]=r.useState(""),[x,D]=r.useState(10);r.useState(""),r.useState("asc"),r.useState("name");const[Z,n]=r.useState(!1),F=async s=>{let a=new Array;s.forEach(t=>{a.push(t)}),U(),v(a)},U=()=>{b({_id:"",name:"",email:"",password:"",role:"user",created:null,lastLogin:null})},f=async()=>{n(!0);try{const s=await M();s.msg==="no-section"?(l.warning("There is no information!"),n(!1)):(await F(s.users),n(!1))}catch(s){l.error(s)}};r.useEffect(()=>{f()},[]);const C=N.filter(s=>{const a=s.name.toLowerCase(),t=s.email.toLowerCase(),h=s.role.toLowerCase(),o=p.toLowerCase();return a.includes(o)||t.includes(o)||h.includes(o)}),u=Math.ceil(C.length/x),R=C.slice((d-1)*x,d*x),g=async(s,a)=>{try{let t=new FormData;Object.keys(s).forEach(o=>{t.append(o,s[o])}),t.set("allowed",a),n(!0);const h=await B(t);h.msg==="no-section"?(l.warning("There is no information!"),n(!1)):h.msg==="update"&&(l.success("The Review information was updated!"),f())}catch(t){l.error(t.response.data)}},S=async s=>{try{n(!0);let a=new FormData;a.append("_id",s);const t=await I(a);t.msg==="no-section"?(l.warning("There is no information!"),n(!1)):t.msg==="delete"&&(l.success("User was deleted successfully!"),f())}catch(a){l.error(a.response.data)}};return e.jsx(O,{children:e.jsx(z,{xs:!0,children:e.jsxs($,{className:"mb-4",children:[e.jsx(G,{children:e.jsx("div",{className:"d-flex flex-row justify-content-start",children:e.jsx(J,{type:"text",placeholder:"Filter by All",value:p,onChange:s=>T(s.target.value),className:"form-control",style:{width:"10rem",left:"0"}})})}),e.jsx(q,{children:e.jsxs(K,{align:"middle",className:"mb-0 border",hover:!0,responsive:!0,children:[e.jsx(Q,{className:"text-nowrap",children:e.jsxs(w,{children:[e.jsx(c,{className:"bg-body-tertiary text-center",children:e.jsx(L,{icon:Y})}),e.jsx(c,{className:"bg-body-tertiary",children:"User"}),e.jsx(c,{className:"bg-body-tertiary",children:"Email"}),e.jsx(c,{className:"bg-body-tertiary text-center",children:"Role"}),e.jsx(c,{className:"bg-body-tertiary text-center",children:"Allow"}),e.jsx(c,{className:"bg-body-tertiary text-center",children:"Delete"})]})}),e.jsx(V,{children:R.map((s,a)=>e.jsxs(w,{"v-for":"item in tableItems",children:[e.jsx(i,{className:"text-center",children:e.jsx(_,{size:"md",src:H})}),e.jsxs(i,{children:[e.jsx("div",{children:s.name}),e.jsxs("div",{className:"small text-body-secondary text-nowrap",children:["Registered: ",E(s.created).format("MMM D, YYYY")]})]}),e.jsx(i,{children:e.jsx("a",{className:"text-info form-link text-center",href:`mailTo:${s.email}`,children:s.email})}),e.jsx(i,{className:"text-center text-success ",children:e.jsx("div",{children:(s==null?void 0:s.role)||"admin"})}),e.jsx(i,{className:"text-center",children:s.allowed?e.jsx(m,{color:"dark",className:"text-light",shape:"rounded-pill",onClick:()=>{g(s,!1)},children:"Deny"}):e.jsx(m,{color:"success",className:"text-light",shape:"rounded-pill",onClick:()=>{g(s,!0)},children:"Allow"})}),e.jsx(i,{className:"text-center",children:e.jsx(m,{color:"danger",className:"text-light",shape:"rounded-pill",onClick:()=>{S(s._id)},children:"Delete"})})]},a))})]})}),e.jsx(k,{children:e.jsxs("div",{className:"d-flex justify-content-center align-items-center",children:[e.jsxs(W,{value:x,onChange:s=>D(Number(s.target.value)),className:"form-select position-absolute mx-1",style:{width:"5rem",left:"0"},children:[e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"})]}),e.jsx(m,{onClick:()=>j(s=>Math.max(s-1,1)),disabled:d===1,className:"btn btn-secondary mx-2",children:e.jsx(y,{icon:P})}),e.jsxs("span",{children:["Page ",d," of ",u]}),e.jsx(m,{onClick:()=>j(s=>Math.min(s+1,u)),disabled:d===u,className:"btn btn-secondary mx-2",children:e.jsx(y,{icon:A})})]})})]})})})};export{xe as default};
